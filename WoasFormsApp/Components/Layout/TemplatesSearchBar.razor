@inject NavigationManager nav
@rendermode InteractiveServer

<MudTextField
@bind-Value="searchText"
@ref="searchField"
Label="Search"
Variant="Variant.Filled"
Adornment="Adornment.End"
AdornmentIcon="@Icons.Material.Filled.Search"
Placeholder="Search for templates"
OnAdornmentClick="Search"
OnKeyDown="EnterKey"
Color="@Color.Inherit"
/>



@code {
    string searchText;
    MudTextField<string> searchField;

    [Parameter]
    [SupplyParameterFromQuery(Name = "search")]
    public string searchString { get; set; }

    protected override async Task OnInitializedAsync()
    {
        if (!string.IsNullOrWhiteSpace(searchString)) searchText = searchString;
    }

    public void EnterKey(KeyboardEventArgs args){
        if (args.Code == "Enter") Search();
    }

    public void Search()
    {
        StateHasChanged();
        var baseUri = "/SearchTemplate";
        var searchParams = new Dictionary<string, object>{
            {"search" , searchText },
        };
        var uriWithParams = nav.GetUriWithQueryParameters(baseUri, searchParams);
        nav.NavigateTo(uriWithParams, forceLoad: true);
    }
}